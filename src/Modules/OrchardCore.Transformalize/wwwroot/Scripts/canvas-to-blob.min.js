(function(n){"use strict";var i=n.HTMLCanvasElement&&n.HTMLCanvasElement.prototype,r=n.Blob&&function(){try{return Boolean(new Blob)}catch(n){return!1}}(),f=r&&n.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch(n){return!1}}(),u=n.BlobBuilder||n.WebKitBlobBuilder||n.MozBlobBuilder||n.MSBlobBuilder,e=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,t=(r||u)&&n.atob&&n.ArrayBuffer&&n.Uint8Array&&function(n){var t,h,v,c,o,s,l,i,a;if(t=n.match(e),!t)throw new Error("invalid data URI");for(h=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),v=!!t[4],c=n.slice(t[0].length),o=v?atob(c):decodeURIComponent(c),s=new ArrayBuffer(o.length),l=new Uint8Array(s),i=0;i<o.length;i+=1)l[i]=o.charCodeAt(i);return r?new Blob([f?l:s],{type:h}):(a=new u,a.append(s),a.getBlob(h))};n.HTMLCanvasElement&&!i.toBlob&&(i.mozGetAsFile?i.toBlob=function(n,r,u){var f=this;setTimeout(function(){u&&i.toDataURL&&t?n(t(f.toDataURL(r,u))):n(f.mozGetAsFile("blob",r))})}:i.toDataURL&&t&&(i.toBlob=i.msToBlob?function(n,r,u){var f=this;setTimeout(function(){(r&&r!=="image/png"||u)&&i.toDataURL&&t?n(t(f.toDataURL(r,u))):n(f.msToBlob(r))})}:function(n,i,r){var u=this;setTimeout(function(){n(t(u.toDataURL(i,r)))})}));typeof define=="function"&&define.amd?define(function(){return t}):typeof module=="object"&&module.exports?module.exports=t:n.dataURLtoBlob=t})(window);