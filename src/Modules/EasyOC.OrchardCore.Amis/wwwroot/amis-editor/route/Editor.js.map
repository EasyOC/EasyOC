{"version":3,"sources":["/route/Editor.tsx"],"names":[],"mappings":"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","file":"Editor.js","sourcesContent":["import React from 'react';\r\nimport {Editor} from 'amis-editor';\r\nimport {inject, observer} from 'mobx-react';\r\nimport {IMainStore} from '../store';\r\nimport {RouteComponentProps} from 'react-router-dom';\r\nimport {Layout, Switch, classnames as cx, toast} from 'amis';\r\nimport '../renderer/MyRenderer';\r\nimport '../editor/MyRenderer';\r\n\r\nlet currentIndex = -1;\r\n\r\nlet host = `${window.location.protocol}//${window.location.host}`;\r\nlet iframeUrl = '/editor.html';\r\n\r\n// 如果在 gh-pages 里面\r\nif (/^\\/amis-editor-demo/.test(window.location.pathname)) {\r\n    host += '/amis-editor';\r\n    iframeUrl = '/amis-editor-demo' + iframeUrl;\r\n}\r\n\r\nconst schemaUrl = `${host}/schema.json`;\r\n\r\n// @ts-ignore\r\n__uri('amis/schema.json');\r\n\r\nexport default inject('store')(\r\n    observer(function ({store, location, history, match}: {store: IMainStore} & RouteComponentProps<{id: string}>) {\r\n        const index: number = parseInt(match.params.id, 10);\r\n\r\n        if (index !== currentIndex) {\r\n            currentIndex = index;\r\n            store.updateSchema(store.pages[index].schema);\r\n        }\r\n\r\n        function save() {\r\n            store.updatePageSchemaAt(index);\r\n            toast.success('保存成功', '提示');\r\n        }\r\n\r\n        function exit() {\r\n            history.push(`/${store.pages[index].path}`);\r\n        }\r\n\r\n        function renderHeader() {\r\n            return (\r\n                <div className=\"editor-header clearfix box-shadow bg-dark\">\r\n                    <div className=\"navbar-brand text-lt font-thin\">AMis 编辑器</div>\r\n\r\n                    <div className=\"editor-preview\">\r\n                        预览{' '}\r\n                        <Switch\r\n                            value={store.preview}\r\n                            onChange={(value: boolean) => store.setPreview(value)}\r\n                            className=\"m-l-xs\"\r\n                            inline\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"editor-preview\">\r\n                        移动端{' '}\r\n                        <Switch\r\n                            value={store.isMobile}\r\n                            onChange={(value: boolean) => store.setIsMobile(value)}\r\n                            className=\"m-l-xs\"\r\n                            inline\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"editor-header-btns\">\r\n                        <div className={cx('btn-item')} onClick={save}>\r\n                            保存\r\n                        </div>\r\n\r\n                        <div className=\"btn-item\" onClick={exit}>\r\n                            退出\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <Layout header={renderHeader()} headerFixed={false}>\r\n                <Editor\r\n                    theme={'default'}\r\n                    preview={store.preview}\r\n                    value={store.schema}\r\n                    onChange={(value: any) => store.updateSchema(value)}\r\n                    className=\"is-fixed\"\r\n                    $schemaUrl={schemaUrl}\r\n                    iframeUrl={iframeUrl}\r\n                    isMobile={store.isMobile}\r\n                />\r\n            </Layout>\r\n        );\r\n    })\r\n);\r\n"]}